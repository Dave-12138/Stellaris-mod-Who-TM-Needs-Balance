decision_wtmnb_create_pop = {
	owned_planets_only = yes
	icon = wtmnb_welt3
	resources = {
		category = decisions
		cost = {
			energy = 100
		}
	}
	potential = {
		solar_system = {
			any_ship_in_system = {
				has_component = WTMNB_6TH_KEY
			}
		}
	}
	effect = {
		custom_tooltip = "add_20_pop"
		hidden_effect = {
			random_owned_pop = {
				species = {
					save_event_target_as = rand_sp
				}
			}
			while = {
				count = 20
				create_pop = {
					species = event_target:rand_sp
				}
			}
		}
	}
	ai_weight = {
		weight = 5000
		modifier = {
			factor = 0
			any_owned_pop = {
				OR = {
					is_unemployed = yes
					has_job = nojob_sexslave
					has_job = nojob_sexslave2
				}
			}
		}
	}
}

decision_wtmnb_reroll = {
	enactment_time = 0
	icon = wtmnb_4th_key
	potential = {
		any_fleet_in_orbit = {
			any_owned_ship = {
				has_component = WTMNB_4TH_KEY
			}
		}
	}
	effect = {
		reroll_deposits = yes
		if = {
			limit = {
				is_planet_class = pc_wtmnb_city
				NOT = {
					has_deposit = deposit_wtmnb_city
				}
			}
			add_deposit = deposit_wtmnb_city
		}
	}
	ai_weight = {
		weight = 0
	}
}

decision_wtmnb_molten = {
	enactment_time = 1
	icon = wtmnb_destructor
	potential = {
		is_star = no
		any_fleet_in_orbit = {
			any_owned_ship = {
				has_component = WTMNB_7TH_KEY
			}
		}
	}
	effect = {
		if = {
			limit = {
				OR = {
					is_planet_class = pc_habitat
					is_planet_class = pc_habitat_shielded
				}
			}
			remove_planet = yes
		}
		else_if = {
			limit = {
				is_ringworld = yes
			}
			change_pc = pc_ringworld_tech_damaged
		}
		else = {
			random_list = {
				50 = {
					change_pc = pc_nuked
				}
				50 = {
					change_pc = pc_molten
				}
			}
		}
		if = {
			limit = {
				is_colonizable = no
			}
			every_owned_pop = {
				kill_pop = yes
			}
		}
		random_list = {
			10 = {
			}
			30 = {
				change_planet_size = 5
			}
			30 = {
				if = {
					limit = {
						planet_size > 5
					}
					change_planet_size = -5
				}
				else = {
					if = {
						limit = {
							is_ringworld = no
						}
						remove_planet = yes
					}
					else = {
						custom_tooltip = "ringworld_will_be_not_colonizable"
						hidden_effect = {
							change_pc = pc_ringworld_seam
						}
					}
				}
			}
		}
	}
	ai_weight = {
		weight = 0
	}
}

decision_wtmnb_break_border = {
	enactment_time = 1
	icon = Eden_wtmnb
	resources = {
		category = decisions
		cost = {
			energy = 8000
		}
	}
	potential = {
		is_star = yes
		solar_system = {
			any_ship_in_system = {
				has_component = WTMNB_9TH_KEY
			}
		}
	}
	allow = {
		solar_system = {
			any_neighbor_system = {
				exists = owner
				owner = {
					has_closed_borders = from
				}
			}
		}
	}
	effect = {
		solar_system = {
			every_neighbor_system = {
				limit = {
					exists = owner
					owner = {
						has_closed_borders = from
					}
				}
				owner = {
					set_closed_borders = {
						who = from
						status = no
					}
				}
			}
		}
	}
}

decision_wtmnb_11th_shield = {
	enactment_time = 1
	icon = star_11th_modifier
	resources = {
		category = decisions
		cost = {
			energy = 8000
		}
	}
	potential = {
		OR = {
			is_star = yes
			solar_system = {
				has_any_megastructure = yes
			}
		}
		solar_system = {
			any_ship_in_system = {
				has_component = WTMNB_11TH_KEY
				has_component = WTMNB_9TH_KEY
			}
			NOT = {
				any_system_planet = {
					has_modifier = wtmnb_star_11th_modifier
				}
			}
		}
	}
	allow = {
		always = yes
	}
	effect = {
		solar_system = {
			system_star = {
				add_modifier = {
					modifier = wtmnb_star_11th_modifier
					days = -1
				}
			}
		}
	}
}

decision_wtmnb_11th_shield_off = {
	enactment_time = 1
	icon = star_11th_modifier
	resources = {
		category = decisions
		cost = {
		}
	}
	potential = {
		OR = {
			is_star = yes
			solar_system = {
				has_any_megastructure = yes
			}
		}
		solar_system = {
			any_ship_in_system = {
				has_component = WTMNB_11TH_KEY
				has_component = WTMNB_9TH_KEY
			}
			any_system_planet = {
				has_modifier = wtmnb_star_11th_modifier
			}
		}
	}
	allow = {
		always = yes
	}
	effect = {
		solar_system = {
			system_star = {
				remove_modifier = wtmnb_star_11th_modifier
			}
			hidden_effect = {
				every_system_planet = {
					remove_modifier = wtmnb_star_11th_modifier
				}
			}
		}
	}
}

decision_wtmnb_city = {
	enactment_time = 1
	icon = wtmnb_4th_key
	resources = {
		category = decisions
		cost = {
			alloys = 8000
			energy = 8000
		}
	}
	potential = {
		is_star = no
		solar_system = {
			any_ship_in_system = {
				has_component = WTMNB_4TH_KEY
				has_component = WTMNB_9TH_KEY
			}
		}
		NOT = {
			has_deposit = deposit_wtmnb_city
		}
	}
	effect = {
		if = {
			limit = { 
				# 不是：
				NOR = {
					# 居住站
					is_planet_class = pc_habitat
					# 环
					change_pc = pc_ringworld_tech_damaged
					change_pc = pc_ringworld_seam_damaged
					change_pc = pc_ringworld_habitable_damaged
					is_planet_class = pc_ringworld_tech
					is_planet_class = pc_ringworld_seam
					is_ringworld = yes
				}
			}
			change_pc = pc_wtmnb_city
			reroll_deposits = yes
		}
		if = {
			limit = {
				NOT = {
					has_deposit = deposit_wtmnb_city
				}
			}
			add_deposit = deposit_wtmnb_city
		}
	}
	ai_weight = {
		weight = 5000
	}
}

decision_wtmnb_planet_extend = {
	enactment_time = 1
	icon = planet_4th_modifier
	owned_planets_only = yes
	potential = {
		OR = {
			solar_system = {
				exists = owner
				owner = {
					has_country_flag = wtmnb_order
				}
			}
			any_fleet_in_orbit = {
				any_owned_ship = {
					has_component = WTMNB_4TH_KEY
				}
			}
		}
	}
	allow = {
		custom_tooltip = {
			fail_text = terraform_needs_4th_key_and_eden_star
			solar_system = {
				any_ship_in_system = {
					has_component = WTMNB_4TH_KEY
				}
			}
		}
	}
	effect = {
		if = {
			limit = {
				NOT = {
					has_modifier = wtmnb_planet_ex
				}
			}
			add_modifier = {
				modifier = wtmnb_planet_ex
				days = -1
			}
		}
		else = {
			add_deposit = deposit_wtmnb_4th_key_expand
		}
	}
	ai_weight = {
		weight = 0
	}
}
