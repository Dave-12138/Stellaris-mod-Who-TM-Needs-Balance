eden_star_zeroth = {
	if = {
		limit = {
			exists = event_target:crisis_country
		}
		fire_on_action = {
			on_action = on_destroy_star_system
			scopes = {
				from = event_target:crisis_country
			}
		}
	}
	else = {
		fire_on_action = {
			on_action = on_destroy_star_system
		}
	}
	set_star_flag = star_cracked
	set_star_class = sc_black_hole
	# 摧毁环境物体
	every_system_ambient_object = {
		limit = {
			# Preserve Unbidden crisis effects
			NOR = {
				has_ambient_object_flag = extradimensional_system_effect
				has_ambient_object_flag = extradimensional_system_effect_2
			}
		}
		destroy_ambient_object = this
	}
	# 恒星
	every_system_planet = {
		limit = {
			is_star = yes
		}
		create_ambient_object = {
			type = "star_explosion"
			play_animation_once = yes
			location = this
		}
		last_created_ambient_object = {
			set_location = {
				target = prev
				distance = 0
				angle = random
			}
		}
		change_pc = pc_black_hole
		reroll_deposits = yes
	}
	# 肃正
	every_system_planet = {
		limit = {
			is_planet_class = pc_ai
			NOT = {
				has_planet_flag = machine_lair
			}
		}
		destroy_machine_world = yes
	}
	random_system_planet = {
		limit = {
			is_planet_class = pc_ai
			has_planet_flag = machine_lair
		}
		event_target:wtmnb_planet_killer_ship.owner = {
			save_event_target_as = final_machine_world_destroyer
		}
		stop_crisis_sound = yes
		planet_event = {
			id = crisis.2046
		}
	}
	# 殖民地
	every_system_planet = {
		limit = {
			is_colony = yes
		}
		# 摧毁轨道防御
		if = {
			limit = {
				exists = orbital_defence
			}
			destroy_fleet = orbital_defence
		}
		every_owned_pop = {
			kill_pop = yes
		}
		remove_all_buildings = yes
		destroy_colony = yes
	}
	# 居住站
	every_system_planet = {
		limit = {
			is_planet_class = pc_habitat
		}
		spawn_habitat_cracker_effect = yes
		remove_planet = yes
	}
	# 环世界
	every_system_planet = {
		limit = {
			OR = {
				is_planet_class = pc_ringworld_tech
				is_planet_class = pc_ringworld_seam
				is_ringworld = yes
			}
		}
		spawn_ringworld_cracker_effect = yes
		change_pc = pc_ringworld_tech_damaged
	}
	# 行星
	every_system_planet = {
		limit = {
			# 不是恒星
			is_star = no
			# 不是小行星
			is_asteroid = no
			# 不是环
			NOR = {
				change_pc = pc_ringworld_tech_damaged
				change_pc = pc_ringworld_seam_damaged
				change_pc = pc_ringworld_habitable_damaged
			}
		}
		change_pc = pc_black_hole
		reroll_deposits = yes
	}
	# 清除异常与修正
	every_system_planet = {
		clear_planet_modifiers = yes
		prevent_anomaly = yes
	}
	# 小行星
	every_system_planet = {
		limit = {
			is_asteroid = yes
		}
		clear_deposits = yes
	}
	# 轨道站
	every_system_planet = {
		limit = {
			exists = {
				exists = orbital_station
			}
			orbital_station = {
				dismantle = yes
			}
		}
	}
	# 舰队
	every_fleet_in_system = {
		limit = {
			NAND = {
				exists = owner
				owner = {
					OR = {
						is_country_type = portal_holder
						is_country_type = extradimensional
						is_country_type = extradimensional_2
						is_country_type = extradimensional_3
						has_country_flag = wtmnb_order
					}
				}
			}
		}
		# 能动的失踪，否则摧毁
		if = {
			limit = {
				exists = event_target:crisis_country
				is_mobile = yes
			}
			set_mia = yes
		}
		else = {
			destroy_fleet = this
		}
	}
	# 摧毁巨构
	every_system_megastructure = {
		set_ruined_megastructure = yes
	}
	# 
	star = {
		create_ambient_object = {
			type = "destroyed_system"
			location = this
		}
		last_created_ambient_object = {
			set_ambient_object_flag = destroyed_system_effect
			set_location = {
				target = prev
				distance = 0
				angle = random
			}
		}
	}
	every_neighbor_system = {
		remove_hyperlane = {
			from = THIS
			to = prev
		}
	}
}

#has_wsg_mod
wtmnb_planet_species_to_wsg = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "Warship_Girls"
			}
		}
		create_species = {
			class = "Warship_Girls"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
			effect = {
				modify_species = {
					change_scoped_species = yes
					add_trait = wsg_trait_warshipgirls
					remove_trait = sh_trait_shenhai
				}
				wtmnb_wsg_ap_species_fix = yes
				wtmnb_normal_species_fix = yes
			}
		}
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_sh = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "ShenHai"
			}
		}
		create_species = {
			class = "ShenHai"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
			effect = {
				modify_species = {
					change_scoped_species = yes
					add_trait = sh_trait_shenhai
					remove_trait = wsg_trait_warshipgirls
					remove_trait = trait_azurlanegirls
				}
				wtmnb_sh_ap_species_fix = yes
				wtmnb_normal_species_fix = yes
			}
		}
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_Azur_Lane_k = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "Azur_Lane_k"
			}
		}
		create_species = {
			class = "Azur_Lane_k"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
			effect = {
				modify_species = {
					change_scoped_species = yes
					add_trait = trait_azurlanegirls
					remove_trait = sh_trait_shenhai
					remove_trait = wsg_trait_warshipgirls
				}
				wtmnb_normal_species_fix = yes
			}
		}
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

#原版种族
wtmnb_planet_species_to_plant = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "PLANT"
			}
		}
		create_species = {
			class = "PLANT"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_hum = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "HUM"
			}
		}
		create_species = {
			class = "HUM"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_mam = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "MAM"
			}
		}
		create_species = {
			class = "MAM"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_rep = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "REP"
			}
		}
		create_species = {
			class = "REP"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_avi = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "AVI"
			}
		}
		create_species = {
			class = "AVI"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_art = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "ART"
			}
		}
		create_species = {
			class = "ART"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_mol = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "MOL"
			}
		}
		create_species = {
			class = "MOL"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_fun = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "FUN"
			}
		}
		create_species = {
			class = "FUN"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_robot = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "ROBOT"
			}
		}
		create_species = {
			class = "ROBOT"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		modify_species = {
			species = last_created_species
			add_trait = trait_mechanical
			change_scoped_species = yes
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_machine = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "MACHINE"
			}
		}
		create_species = {
			class = "MACHINE"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		modify_species = {
			species = last_created_species
			add_trait = trait_mechanical
			change_scoped_species = yes
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_lithoid = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "LITHOID"
			}
		}
		create_species = {
			class = "LITHOID"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		modify_species = {
			species = last_created_species
			add_trait = trait_lithoid
			change_scoped_species = yes
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

wtmnb_planet_species_to_necroid = {
	every_owned_species = {
		limit = {
			NOT = {
				is_species_class = "NECROID"
			}
		}
		create_species = {
			class = "NECROID"
			is_mod = yes
			name = this
			plural = this
			portrait = this
			traits = this
			homeworld = prev
		}
		wtmnb_normal_species_fix = yes
		prev = {
			every_owned_pop = {
				limit = {
					is_same_species = prevprev
				}
				change_species = last_created_species
			}
		}
	}
}

#舰R 飞升 特质 fix(置于尾修饰后
wtmnb_sh_ap_species_fix = {
	if = {
		limit = {
			event_target:wtmnb_target = {
				any_owned_pop = {
					has_trait = sh_trait_shenhai1
				}
			}
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			add_trait = sh_trait_shenhai1
			remove_trait = sh_trait_shenhai
		}
	}
	if = {
		limit = {
			event_target:wtmnb_target = {
				any_owned_pop = {
					has_trait = sh_trait_shenhai2
				}
			}
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			add_trait = sh_trait_shenhai2
			remove_trait = sh_trait_shenhai
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			remove_trait = sh_trait_shenhai1
		}
	}
	if = {
		limit = {
			event_target:wtmnb_target = {
				any_owned_pop = {
					has_trait = sh_trait_shenhai3
				}
			}
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			add_trait = sh_trait_shenhai3
			remove_trait = sh_trait_shenhai
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			remove_trait = sh_trait_shenhai1
		}
	}
}

wtmnb_wsg_ap_species_fix = {
	if = {
		limit = {
			event_target:wtmnb_target = {
				any_owned_pop = {
					has_trait = wsg_trait_warshipgirls1
				}
			}
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			add_trait = wsg_trait_warshipgirls1
			remove_trait = wsg_trait_warshipgirls
		}
	}
	if = {
		limit = {
			event_target:wtmnb_target = {
				any_owned_pop = {
					has_trait = wsg_trait_warshipgirls2
				}
			}
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			add_trait = wsg_trait_warshipgirls2
			remove_trait = wsg_trait_warshipgirls1
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			remove_trait = wsg_trait_warshipgirls
		}
	}
	if = {
		limit = {
			event_target:wtmnb_target = {
				any_owned_pop = {
					has_trait = wsg_trait_mist
				}
			}
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			add_trait = wsg_trait_mist
			remove_trait = wsg_trait_warshipgirls1
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			remove_trait = wsg_trait_warshipgirls
		}
	}
}

#常规 特质 fix(置于尾修饰后
wtmnb_normal_species_fix = {
	modify_species = {
		species = last_created_species
		change_scoped_species = yes
		remove_trait = trait_hive_mind
	}
	modify_species = {
		species = last_created_species
		change_scoped_species = yes
		remove_trait = trait_machine_unit
	}
	if = {
		limit = {
			event_target:wtmnb_target = {
				owner = {
					is_machine_empire = yes
				}
			}
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			add_trait = trait_machine_unit
			remove_trait = trait_mechanical
		}
	}
	if = {
		limit = {
			event_target:wtmnb_target = {
				owner = {
					is_hive_empire = yes
				}
			}
		}
		modify_species = {
			species = last_created_species
			change_scoped_species = yes
			add_trait = trait_hive_mind
			remove_trait = trait_mechanical
		}
	}
}
